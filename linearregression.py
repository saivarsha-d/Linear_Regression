# -*- coding: utf-8 -*-
"""LinearRegression.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1doCJusnzfVpL4uLyHFNHa1WUn9mKzljf
"""

import numpy as np
import matplotlib.pyplot as plt
import pandas as pd

df = pd.read_csv('salary_Data.csv')
df

df.head(2)

x = df.iloc[:, 0:1].values
y = df.iloc[:, 1].values

x.shape

x

y

from sklearn.model_selection import train_test_split

x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state=2)

x_train.shape

x_test.shape

y_train.shape

y_test.shape

from sklearn.linear_model import LinearRegression

model = LinearRegression()
model.fit(x_train, y_train)

model.intercept_

model.coef_

model.score(x_train, y_train)

model.score(x_test,y_test)

predictions = model.predict(x_test)

pd.DataFrame({'Actual': y_test, 'Predicted': predictions})

plt.scatter(x_train,y_train,color='blue')
plt.plot(x_train,model.predict(x_train),color='red')
plt.title('TrainingData')
plt.xlabel('Years of Experience')
plt.ylabel('Salary')
plt.show()

plt.scatter(x_test,y_test,color='blue')
plt.plot(x_train,model.predict(x_train),color='red')
plt.title('TestingData')
plt.xlabel('Years of Experience')
plt.ylabel('Salary')
plt.show()

years_of_experience = np.array([[5]])
predicted_salary = model.predict(years_of_experience)

print(f"Predicted salary for {years_of_experience[0][0]} years of experience: {predicted_salary[0]:.2f}")

